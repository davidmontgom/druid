[

<% @realtime_list.each_with_index do |realtime_hash, index| %>
  {
    "dataSchema" : {
      "dataSource" : "<%=realtime_hash["dataSource"]%>",
      "parser" : {
        "type" : "string",
        "parseSpec" : {
          "format" : "json",
          "timestampSpec" : {
            "column": "utcdt",
            "format": "iso"
          },
          "dimensionsSpec" : {
            "dimensions": [],
            "dimensionExclusions" : [],
            "spatialDimensions" : []
          }
        }
      },
      "metricsSpec" : [{
        "type" : "count",
        "name" : "<%=realtime_hash["name"]%>"
      }],
      "granularitySpec" : {
        "type" : "uniform",
        "segmentGranularity" : "minute",
        "queryGranularity" : "NONE"
      }
    },
    "ioConfig" : {
      "type" : "realtime",
      "firehose": {
        "type": "kafka-0.8",
        "consumerProps": {
          "zookeeper.connect": "<%=@zookeeper%>",
          "zookeeper.connection.timeout.ms" : "15000",
          "zookeeper.session.timeout.ms" : "15000",
          "zookeeper.sync.time.ms" : "5000",
          "group.id": "<%=realtime_hash["group.id"]%>",
          "fetch.message.max.bytes" : "1048586",
          "auto.offset.reset": "largest",
          "auto.commit.enable": "false"
        },
        "feed": "<%=realtime_hash["feed"]%>"
      },
      "plumber": {
        "type": "realtime"
      }
    },
    "tuningConfig": {
      "shardSpec": {
        		"type": "linear",
        		"partitionNum": <%=@partitionNum%>
      },
      "type" : "realtime",
      "maxRowsInMemory": 500000,
      "intermediatePersistPeriod": "PT10m",
      "windowPeriod": "PT10m",
      "basePersistDirectory": "\/tmp\/realtime\/basePersist",
      "rejectionPolicy": {
        "type": "serverTime"
      }
    }
  }
  <% if index != @realtime_list.size-1 =%>
    ,
  <% end %>
  
 <% end %>
]